<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erg Screen Reader</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8 mx-auto">
                <div class="main-content">
                    <!-- Header -->
                    <div class="text-center mb-5">
                        <h1 class="display-4 fw-bold" style="color: var(--columbia-blue-dark);">
                            <i class="fas fa-rowing me-3"></i>Erg Screen Reader
                        </h1>
                        <p class="lead" style="color: var(--dark-text);">Upload your erg screenshots and get structured workout data</p>
                        <div class="mt-3">
                            <span class="badge rounded-pill px-3 py-2" style="background: linear-gradient(45deg, var(--columbia-blue), var(--columbia-blue-dark)); color: white; font-size: 0.9rem;">
                                <i class="fas fa-graduation-cap me-2"></i>Columbia Team Edition
                            </span>
                        </div>
                    </div>

                    <!-- Upload Form -->
                    <div class="card shadow-lg">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-upload me-2"></i>Upload Workout Image</h5>
                        </div>
                        <div class="card-body">
                            <form id="uploadForm" enctype="multipart/form-data">
                                <!-- File Upload -->
                                <div class="mb-4">
                                    <label for="file" class="form-label fw-bold">Select Image File</label>
                                    <div class="upload-area" id="uploadArea">
                                        <div class="upload-content">
                                            <i class="fas fa-cloud-upload-alt fa-3x mb-3" style="color: var(--columbia-blue);"></i>
                                            <p class="mb-2 fw-bold" style="color: var(--dark-text);">Drag and drop your erg screenshot here</p>
                                            <p class="small" style="color: var(--light-text);">or</p>
                                            <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('file').click()">
                                                <i class="fas fa-file-image me-2"></i>Choose File
                                            </button>
                                        </div>
                                        <input type="file" id="file" name="file" accept="image/*" class="d-none" required>
                                    </div>
                                    <div id="fileInfo" class="mt-2 d-none">
                                        <div class="alert alert-info d-flex align-items-center">
                                            <i class="fas fa-file-image me-2"></i>
                                            <span id="fileName"></span>
                                            <button type="button" class="btn-close ms-auto" onclick="clearFile()"></button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Workout Settings -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="workout_type" class="form-label fw-bold">Workout Type</label>
                                        <select class="form-select" id="workout_type" name="workout_type" required>
                                            <option value="regular">Regular Workout</option>
                                            <option value="interval">Interval Workout</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="name" class="form-label fw-bold">Rower Name</label>
                                        <input type="text" class="form-control" id="name" name="name" value="John C150" required>
                                    </div>
                                </div>

                                <!-- Output Format -->
                                <div class="mb-4">
                                    <label class="form-label fw-bold">Output Format</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="output_format" id="excel_format" value="excel" checked>
                                        <label class="form-check-label" for="excel_format">
                                            <i class="fas fa-file-excel me-2 text-success"></i>Excel File
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="output_format" id="sheets_format" value="sheets">
                                        <label class="form-check-label" for="sheets_format">
                                            <i class="fab fa-google me-2 text-primary"></i>Google Sheets
                                        </label>
                                    </div>
                                </div>

                                <!-- Excel Options -->
                                <div id="excelOptions" class="mb-4">
                                    <label class="form-label fw-bold">Excel Options</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="spreadsheet_option" id="new_spreadsheet" value="new" checked>
                                        <label class="form-check-label" for="new_spreadsheet">
                                            Create New Spreadsheet
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="spreadsheet_option" id="existing_spreadsheet" value="existing">
                                        <label class="form-check-label" for="existing_spreadsheet">
                                            Add to Existing Spreadsheet
                                        </label>
                                    </div>
                                </div>

                                <!-- Google Sheets Options -->
                                <div id="sheetsOptions" class="mb-4 d-none">
                                    <label for="sheet_name" class="form-label fw-bold">Google Sheet Name</label>
                                    <input type="text" class="form-control" id="sheet_name" name="sheet_name" placeholder="Leave empty for auto-generated name">
                                    <div class="form-text">Auto-generated name format: [Rower Name] - YYYY-MM-DD HH:MM:SS</div>
                                </div>

                                <!-- Existing File Selection -->
                                <div id="existingFileSection" class="mb-4 d-none">
                                    <label for="existing_filename" class="form-label fw-bold">Select Existing File</label>
                                    <select class="form-select" id="existing_filename" name="existing_filename">
                                        <option value="">Choose a file...</option>
                                    </select>
                                    <div class="form-text">Select an existing Excel file to append your workout data</div>
                                </div>

                                <!-- Submit Button -->
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                        <i class="fas fa-play me-2"></i>Process Workout
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div id="resultsSection" class="mt-5 d-none">
                        <div class="card shadow-lg">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0"><i class="fas fa-check-circle me-2"></i>Processing Complete</h5>
                            </div>
                            <div class="card-body">
                                <div id="resultsContent"></div>
                                <div class="text-center mt-3">
                                    <button class="btn btn-success" id="downloadBtn">
                                        <i class="fas fa-download me-2"></i>Download Excel File
                                    </button>
                                    <button class="btn btn-outline-secondary ms-2" onclick="resetForm()">
                                        <i class="fas fa-plus me-2"></i>Process Another Workout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Spinner -->
                    <div id="loadingSpinner" class="text-center mt-5 d-none">
                        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 text-muted">Processing your workout image...</p>
                    </div>

                    <!-- Error Messages -->
                    <div id="errorSection" class="mt-3 d-none">
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <span id="errorMessage"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html> 